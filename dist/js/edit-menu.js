!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=jQuery,o=wp.i18n,a=o.sprintf,c=(o.__,function(){function e(t,n,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.image=0,this.$el=i(n),this.elements(this.$el.find(o),a),this.media=null,this.checkImage(),this.initialized=!1}var t,o,c;return t=e,(o=[{key:"checkImage",value:function(){var e=this;wp.apiFetch({path:a("bootstrapress/v1/menu/%d/image",this.id)}).then((function(t){t.success&&(e.image=t.id,e.setImage(t.src,t.title))})).catch((function(e){window.console&&console.log(e)})).finally((function(){e.initialized=!0}))}},{key:"setImage",value:function(e,t){var n=this.$el.find(".bp-image");e?n.length?n.find("img").attr("src",e):this.$el.find(".bp-image-button").before(a('\n            <figure class="bp-image">\n                <img class="bp-image-img" src="%1$s" alt="%2$s" />\n                <figcaption class="bp-image-caption">%2$s</figcaption>\n                <button class="bp-image-delete"><span class="dashicons dashicons-no"></span></button>\n            </figure>\n        ',e,t)):n.remove(),this.initialized&&i(document).trigger("bp-image-changed",[this.$el])}},{key:"imageSelect",value:function(){var e=this;this.media||(this.media=wp.media({className:"media-frame bp-image-selector",frame:"select",multiple:!1,title:BootStrapMenu.title,library:{type:"image"},button:{text:BootStrapMenu.button}}),this.media.on("select",(function(){e.media.state().get("selection").each((function(t){var n=t.toJSON().id;wp.apiFetch({path:a("bootstrapress/v1/menu/%d/image",e.id),method:"POST",data:{attachment_id:n}}).then((function(t){e.image=t.id,e.setImage(t.src,t.title)})).catch((function(e){window.console&&console.log(e)}))}))}))),this.media.open()}},{key:"deleteImage",value:function(){var e=this;wp.apiFetch({path:a("bootstrapress/v1/menu/%d/image",this.id),method:"DELETE"}).then((function(t){e.image=0,e.setImage(""),i(document).trigger("bp-image-changed",[e.$el])})).catch((function(e){window.console&&console.log(e)}))}},{key:"elements",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"after",o=i(a('\n    <div class="bp-image-wrapper">\n      <label class="bp-image-label">%s</label>\n      <button class="button bp-image-button">%s</button>\n    </div>\n    ',BootStrapMenu.label,BootStrapMenu.open));o.on("click",".bp-image-button",(function(e){e.preventDefault(),t.imageSelect()})),o.on("click",".bp-image-delete",(function(e){e.preventDefault(),t.deleteImage()})),e[n](o)}}])&&n(t.prototype,o),c&&n(t,c),e}()),r=function(e,t,n){var o=i(e).attr("id").replace(/[^0-9]/g,"");new c(o,e,t,n)};i(document).ready((function(){i(".menu-item").each((function(e,t){r(t,".field-move","before")}))})),i(document).on("menu-item-added",(function(e,t){r(t[0],".field-move","before")}));i(document).ready((function(){i(".control-section-nav_menu").each((function(e,t){!function(e){var t=[],n=i(e).attr("id").replace(/\D/gm,"");i(e).on("click",(function(){var e=i("#customize-control-nav_menu-".concat(n,"-name")).parents(".control-section-nav_menu");setTimeout((function(){e.find(".customize-control-nav_menu_item").each((function(e,n){var o=i(n).attr("id");0>t.indexOf(o)&&!i(n).find(".bp-image-button").length&&(t.push(o),r(n,".menu-item-actions","before"))}))}),10)}))}(t)}))})),i(document).on("expand",".customize-control-nav_menu_item",(function(){var e=i(this);e.find(".bp-image-button").length||e.attr("id").match(/--\d+$/)||r(this,".menu-item-actions","before")})),i(document).on("bp-image-changed",(function(e,t){if(wp.customize){var n=i("iframe[name^=customize-preview]")[0];if(!n)return;var o=n.contentWindow?n.contentWindow:n.contentDocument.defaultView;o&&o.wp&&o.wp.customize&&o.wp.customize.preview.send("refresh")}}))}]);